{% extends 'staff/blog/base.html' %}
{% load flash %}
{% load custom_html %}
{% block scripts %}
<script type="text/javascript" src="/media/jquery/jquery-1.1.3.1.pack.js"></script>
<script type="text/javascript" src="/media/js/blog/entry_form_formatter.js"></script>
<script type="text/javascript">
$(document).ready(function() {
	attachFormatter($('#id_bio'), false);
});
</script>
{% endblock scripts %}
{% block title %} - Editing profile for {{ profile.user.get_full_name }}{% endblock title %}
{% block header %}Editing profile for {{ profile.user.get_full_name }}{% endblock header %}
{% block content %}
{% flash %}
<div class="flash {{ params.type }}">{{ msg }}{% if params.new %} <a href="{{ params.new.get_absolute_url }}">View post &raquo;</a>{% endif %}</div>
{% endflash %}

	<form enctype="multipart/form-data" action="" method="post">
		{% if form.has_errors %}
		<div class="flash failure">There were errors in the submission. Please check below for details.</div>
		{% endif %}
		<fieldset id="form-content">
			<legend>Profile</legend>
			<div class="form-field{% if form.first_name.errors %} form-errors{% endif %}"><label for="id_{{ form.first_name.name }}">{{ form.first_name.label }}</label><br/>{{ form.first_name }}{% if form.first_name.errors %}<br/><span>{{ form.first_name.errors|join:", " }}</span>{% endif %}</div>
			<div class="form-field{% if form.last_name.errors %} form-errors{% endif %}"><label for="id_{{ form.last_name.name }}">{{ form.last_name.label }}</label><br/>{{ form.last_name }}{% if form.last_name.errors %}<br/><span>{{ form.last_name.errors|join:", " }}</span>{% endif %}</div>
			<div class="form-field{% if form.email.errors %} form-errors{% endif %}" style="clear: left"><label for="id_{{ form.email.name }}">{{ form.email.label }}</label><br/>{{ form.email }}{% if form.email.errors %}<br/><span>{{ form.email.errors|join:", " }}</span>{% endif %}</div>
			<div class="form-field{% if form.homepage.errors %} form-errors{% endif %}"><label for="id_{{ form.homepage.name }}">{{ form.homepage.label }}</label><br/>{{ form.homepage }}{% if form.homepage.errors %}<br/><span>{{ form.homepage.errors|join:", " }}</span>{% endif %}</div>
			<div class="form-field{% if form.bio.errors %} form-errors{% endif %}" style="clear: left"><label for="id_{{ form.bio.name }}">{{ form.bio.label }}</label><br/>{{ form.bio }}{% if form.bio.errors %}<br/><span>{{ form.bio.errors|join:", " }}</span>{% endif %}</div>
			{% for field in form %}
				{% comment %}
				{% ifnotequal field.label 'Portrait' %}{% ifnotequal field.label 'New password' %}{% ifnotequal field.label 'Repeat new password' %}
				<div class="form-field{% if field.errors %} form-errors{% endif %}"><label for="id_{{ field.name }}">{{ field.label }}</label><br/>{{ field }}{% if field.errors %}<br/><span>{{ field.errors|join:", " }}</span>{% endif %}</div>
				{% endifnotequal %}{% endifnotequal %}{% endifnotequal %}
				{% endcomment %}
			{% endfor %}
		</fieldset>
		
		<fieldset id="form-uploads">
			<legend>Portrait</legend>
			<div class="form-field{% if form.portrait.errors %} form-errors{% endif %}"><label for="id_portrait">{{ form.portrait.label }} (try to keep photos to 100x100 pixels)</label><br/>{{ form.portrait }}{% if form.portrait.errors %}<br/><span>{{ form.portrait.errors|join:", " }}</span>{% endif %}</div>
			{% if profile.portrait %}<div class="form-field" style="clear: left"><label>Current portrait ({{ profile.get_portrait_width }}x{{ profile.get_portrait_height }} pixels):</label><br/><img src="{{ profile.get_portrait_url }}" style="width:{{ profile.get_portrait_width }}px" class="profile-photo" /></div>{% endif %}
		</fieldset>

		<fieldset id="form-categories">
			<legend>Change password</legend>
			<div class="form-field{% if form.password1.errors %} form-errors{% endif %}"><label for="id_password1">{{ form.password1.label }}</label><br/>{{ form.password1 }}{% if form.password1.errors %}<br/><span>{{ form.password1.errors|join:", " }}</span>{% endif %}</div>
			<div class="form-field{% if form.password2.errors %} form-errors{% endif %}"><label for="id_password2">{{ form.password2.label }}</label><br/>{{ form.password2 }}{% if form.password2.errors %}<br/><span>{{ form.password2.errors|join:", " }}</span>{% endif %}</div>
		</fieldset>

		<button id="form-submit" type="submit">Save profile</button>
	</form>
{% endblock content %}
{% block sidebar %}
<div>
	<p><a href="{% url shameless.staff.views.user_logout %}">Logout</a><br/><a href="{% url shameless.staff.blog.views.entries_index %}">View all blog entries</a></p>
	<p>Problems? Talk to the webmaster.</p>
</div>
{% endblock sidebar %}